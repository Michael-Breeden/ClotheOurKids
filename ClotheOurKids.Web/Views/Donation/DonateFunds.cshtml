<!--=== Interactive Slider ===-->
<div class="breadcrumbs-v3 breadcrumbs-lg img-cooperative text-center">
    <div class="container">
        <h1 class="text-white">Donate</h1>
        <h2 class="promo-text-v2 animated color-light fadeInUp wow margin-bottom-20" data-wow-duration="2s" data-wow-delay="1s">100% of online donations go towards clothing children</h2>
    </div>
</div>
<!--=== End Interactive Slider ===-->

<div class="container content">
    <div class="row margin-bottom-30">
        <div class="col-md-7 md-margin-bottom-30">
            <form method="post" id="donate-form" class="sky-form sky-changes-3" action="/Donation/Payment">
                <header>Give Today</header>
                <fieldset>
                    <div class="row">
                        <section class="col col-3">
                            <button type="button" class="btn btn-danger btn-lg rounded-3x" style="min-width: 100px;">$250</button>
                        </section>
                        <section class="col col-3">
                            <button type="button" class="btn btn-danger btn-lg rounded-3x" style="min-width: 100px;">$100</button>
                        </section>
                        <section class="col col-3">
                            <button type="button" class="btn btn-danger btn-lg rounded-3x" style="min-width: 100px;">$50</button>
                        </section>
                        <section class="col col-3">
                            <button type="button" class="btn btn-danger btn-lg rounded-3x" style="min-width: 100px;">$20</button>
                        </section>
                    </div>
                    <section>
                        <label class="input">
                            <i class="icon-prepend fa fa-dollar"></i>
                            <input type="text" name="amount" placeholder="Other Amount" />
                        </label>
                    </section>
                </fieldset>
                <fieldset>
                    <div class="row">
                        <section class="col col-6">
                            <label class="input">
                                <i class="icon-prepend fa fa-user"></i>
                                <input type="text" name="firstName" placeholder="First name" />
                            </label>
                        </section>
                        <section class="col col-6">
                            <label class="input">
                                <i class="icon-prepend fa fa-user"></i>
                                <input type="text" name="lastName" placeholder="Last name" />
                            </label>
                        </section>
                    </div>
                    <div class="row">
                        <section class="col col-6">
                            <label class="input">
                                <i class="icon-prepend fa fa-envelope"></i>
                                <input type="email" name="email" placeholder="Email" />
                            </label>
                        </section>
                        <section class="col col-6">
                            <label class="input">
                                <i class="icon-prepend fa fa-envelope"></i>
                                <input type="email" name="confirmEmail" placeholder="Confirm Email" />
                            </label>
                        </section>
                    </div>
                </fieldset>
                <fieldset>
                    <div class="row">
                        <section class="col col-5">
                            <label class="select">
                                <select name="country"></select><i></i>
                            </label>
                        </section>
                        <section class="col col-4">
                            <label class="input">
                                <input type="text" name="city" placeholder="City" />
                            </label>
                        </section>
                        <section class="col col-3">
                            <label class="input">
                                <input type="text" name="postalCode" placeholder="Postal Code" />
                            </label>
                        </section>
                    </div>
                    <section>
                        <label class="input">
                            <input type="text" name="address" placeholder="Address" />
                        </label>
                    </section>
                    <section>
                        <label class="input">
                            <i class="icon-prepend fa fa-phone"></i>
                            <input type="tel" name="phone" placeholder="Phone" />
                        </label>
                    </section>
                </fieldset>
                <fieldset>
                    <section>
                        <div class="inline-group">
                            <label class="radio"><input type="radio" name="radio-inline" checked><i></i>Visa</label>
                            <label class="radio"><input type="radio" name="radio-inline"><i></i>MasterCard</label>
                            <label class="radio"><input type="radio" name="radio-inline"><i></i>AMEX</label>
                            <label class="radio"><input type="radio" name="radio-inline"><i></i>Discover</label>
                        </div>
                    </section>
                    <section>
                        <label class="input">
                            <input type="text" id="cc-name" class="stripe-sensitive" placeholder="Name on card" data-stripe="name" />
                        </label>
                    </section>
                    <div class="row">
                        <section class="col col-10">
                            <label class="input">
                                <input type="text" id="cardNumber" class="stripe-sensitive" placeholder="Card Number" data-stripe="number" />
                            </label>
                        </section>
                        <section class="col col-2">
                            <label class="input">
                                <input type="text" id="cvc" class="stripe-sensitive" placeholder="CVC" data-stripe="cvc" />
                            </label>
                        </section>
                    </div>
                    <div class="row">
                        <label class="label col col-4">Expiration date</label>
                        <section class="col col-5">
                            <label class="select">
                                <select id="card-expiry-month" class="stripe-sensitive" data-stripe="exp_month"></select>
                                <i></i>
                            </label>
                        </section>
                        <section class="col col-3">
                            <label class="select">
                                <select id="card-expiry-year" class="stripe-sensitive" data-stripe="exp_year"></select>
                                <i></i>
                            </label>
                        </section>
                    </div>
                    <span class="payment-errors"></span>
                </fieldset>
                <footer>
                    <button type="submit" class="button">Give Now</button>
                </footer>
            </form>
        </div>
    </div>
</div>

@section scripts
{
    <script src="~/assets/plugins/wow-animations/js/wow.min.js"></script>
    <script src="~/assets/plugins/jquery.parallax.js"></script>
    <script type="text/javascript" src="assets/plugins/sky-forms-pro/skyforms/js/jquery.form.min.js"></script>
    <script type="text/javascript" src="assets/plugins/sky-forms-pro/skyforms/js/jquery.validate.min.js"></script>
    <script src="~/assets/plugins/sky-forms-pro/skyforms/js/jquery.maskedinput.min.js"></script>
    <script type="text/javascript" src="https://js.stripe.com/v2/"></script>
    <script type="text/javascript">
        $(document).ready(function () {

            App.init();
            new WOW().init();
            App.initParallaxBg();

            Stripe.setPublishableKey('pk_test_0VALBOTqPslV0xAmQKw8QSxU');


            var selectMonth = $("#card-expiry-month"),
                            month = new Date().getMonth() + 1;
            for (var i = 1; i <= 12; i++) {
                selectMonth.append($("<option value='" + i + "' " + (month === i ? "selected" : "") + ">" + i + "</option>"))
            }


            var select = $("#card-expiry-year"),
                                        year = new Date().getFullYear();
            for (var i = 0; i < 12; i++) {
                select.append($("<option value='" + (i + year) + "' " + (i === 0 ? "selected" : "") + ">" + (i + year) + "</option>"))
            }

            function addInputNames() {
                $('#cardNumber').attr('name', 'cardNumber');
                $('#cvc').attr('name', 'cvc');
                $('#card-expiry-year').attr('name', 'card-expiry-year');

            };

            function removeInputNames() {
                $('#cardNumber').removeAttr("name");
                $('#cvc').removeAttr("name");
                $('#card-expiry-year').removeAttr("name");

            };



            $(function () {



                var $form = $('#donate-form');

                $form.submit(function (event) {
                    //remove the input file names for security so they are not sent to the server
                    removeInputNames(); //THIS IS IMPORTANT!!!!!


                    // Disable the submit button to prevent repeated clicks:
                    $form.find('.submit').prop('disabled', true);

                    //Request a token from Stripe:
                    Stripe.card.createToken($form, stripeResponseHandler);

                    //Prevent the form from being submitted:
                    return false;
                });

                function stripeResponseHandler(status, response) {
                    // Grab the form:
                    var $form = $('#donate-form');

                    if (response.error) { // Problem!

                        // Show the errors on the form:
                        $form.find('.payment-errors').text(response.error.message);
                        $form.find('.submit').prop('disabled', false); // Re-enable submission

                        //add names back in so they can be revalidated properly
                        addInputNames();

                    } else { // Token was created!

                        // Get the token ID:
                        var token = response.id;

                        // Insert the token ID into the form so it gets submitted to the server:
                        $form.append($('<input type="hidden" name="stripeToken">').val(token));

                        // Submit the form:
                        $form.get(0).submit();
                    }
                };
            });

            $(function () {
                //Masking
                $('#cvc').mask('999', { placeholder: 'X' });
                $('#cardNumber').mask('9999-9999-9999-9999', { placeholder: 'X' });


                // add custom rules for credit card validating
                jQuery.validator.addMethod("cardNumber", Stripe.validateCardNumber, "Please enter a valid card number");
                jQuery.validator.addMethod("cardCVC", Stripe.validateCVC, "Please enter a valid security code");
                jQuery.validator.addMethod("cardExpiry", function () {
                    return Stripe.validateExpiry($("#card-expiry-month").val(),
                                                 $("#card-expiry-year").val())
                }, "Please enter a valid expiration");

                // Validation
                $('#donate-form').validate(
                {
                    // Rules for form validation
                    rules:
                    {
                        firstName:
                        {
                            required: true
                        },
                        lastName:
                        {
                            required: true
                        },
                        email:
                        {
                            required: true,
                            email: true
                        },
                        confirmEmail:
                        {
                            required: true,
                            email: true
                        },
                        phone:
                        {
                            required: true
                        },
                        country:
                        {
                            required: true
                        },
                        city:
                        {
                            required: true
                        },
                        postalCode:
                        {
                            required: true,
                            digits: true
                        },
                        address:
                        {
                            required: true
                        },
                        cardNumber:
                        {
                            cardNumber: true,
                            required: true
                        },
                        cvc:
                        {
                            cardCVC: true,
                            required: true
                        },
                        'card-expiry-year': "cardExpiry"
                    },

                    // Messages for form validation
                    messages:
                    {
                        firstName:
                        {
                            required: 'Please enter your first name'
                        },
                        lastName:
                        {
                            required: 'Please enter your last name'
                        },
                        email:
                        {
                            required: 'Please enter your email address',
                            email: 'Please enter a VALID email address'
                        },
                        confirmEmail:
                        {
                            required: 'Please confirm your email address',
                            email: 'Please enter a VALID email address'
                        },
                        phone:
                        {
                            required: 'Please enter your phone number'
                        },
                        country:
                        {
                            required: 'Please select your country'
                        },
                        city:
                        {
                            required: 'Please enter your city'
                        },
                        postalCode:
                        {
                            required: 'Please enter code',
                            digits: 'Digits only please'
                        },
                        address:
                        {
                            required: 'Please enter your full address'
                        }
                    },

                    // Do not change code below
                    errorPlacement: function (error, element) {
                        error.insertAfter(element.parent());
                    }
                });

            });


            addInputNames();
        });




    </script>
}
